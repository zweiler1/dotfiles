#!/usr/bin/env sh

MONITOR_COUNT=$(hyprctl monitors -j | jq 'length')
if [ "$MONITOR_COUNT" -eq 1 ]; then
	if [ "$(hyprctl monitors -j | jq '.[0].name' | grep "eDP")" != "" ]; then
		# Only internal screen active
		qs -c noctalia-shell ipc call toast send '{"title": "Screen Not Disabled", "body": "Only internal screen detected, not turning it off", "icon": "screen-share-off"}'
		echo "Only one screen detected, no toggling"
		exit
	fi
fi

CONFIG_PATH="$HOME/.config/hypr/hyprland.conf"
sed -ie "s/#[ ]*\(monitor[ ]*=[ ]*eDP-1[^\$]*\)/##\1/g" "$CONFIG_PATH"
sed -ie "s/#[ ]*\(monitor[ ]*=[ ]*eDP-2[^\$]*\)/##\1/g" "$CONFIG_PATH"
sed -ie "s/^\(monitor[ ]*=[ ]*eDP-1[^\$]*\)/#\1/g" "$CONFIG_PATH"
sed -ie "s/^\(monitor[ ]*=[ ]*eDP-2[^\$]*\)/#\1/g" "$CONFIG_PATH"
sed -ie "s/##[ ]*\(monitor[ ]*=[ ]*eDP-1[^\$]*\)/\1/g" "$CONFIG_PATH"
sed -ie "s/##[ ]*\(monitor[ ]*=[ ]*eDP-2[^\$]*\)/\1/g" "$CONFIG_PATH"

hyprctl reload
